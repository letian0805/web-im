<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>环信WebIM</title>
    <link rel="stylesheet" href="css/webim.css">

    <!-- sdk及所需的js文件 -->
    <script src="js/sdk/strophe.js"></script>
    <script src="js/sdk/easemob.im-2.0.js"></script>

    <!-- demo依赖的js文件 -->
    <script src="js/lib/avalon.min.js"></script><!-- demo使用的mv框架 -->
    <script src="js/lib/swfupload/swfupload.js"></script><!-- 低版本使用此库上传文件 -->
    <script src="js/easemob.im.config.js"></script><!-- demo使用sdk的配置 -->
    <script src="js/easemob.im.js"></script><!-- demo业务相关 -->
</head>
<body>
    
    <div ms-controller='signin' ms-include='emimSignin'></div><!-- 登录界面 -->
    <div ms-controller='signup' ms-include='emimSignup'></div><!-- 注册界面 -->
    <div ms-controller='chat' ms-include='emimChat'></div><!-- 聊天主界面 -->
    <footer class='emim-w100'>© 2015 easemob</footer><!-- footer -->


    <!----------------MODULES-------------------->
    <!-- 登录界面 -->
    <script id='emimSignin' type='tpl'>
    <div ms-visible='display' class='emim-prl emim-auto emim-mt80 emim-sign-wrapper'>
        <div class='emim-font emim-center emim-bigger-size emim-theme emim-mt20'>0</div>
        <h3 class='emim-w100 emim-center emim-theme emim-smaller-size emim-normal-weight emim-mt20'>WebIM of Easemob</h3>
        <input type='text' autofocus='autofocus' placeholder='Username' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='username' ms-keydown='signin' ms-focus='active' ms-blur='check'>
        <input type='password' ms-attr-placeholder='port' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='password' ms-keydown='signin' ms-blur='check' ms-focus='active'>
        <i class='emim-font' ms-click='transfer'>{{content}}</i>
        <button class='emim-db emim-w80 emim-auto emim-mt40 emim-themebg emim-center emim-main-btn' ms-click='signin'>Sign in</button>
        <button class='emim-db emim-w80 emim-auto emim-theme emim-center emim-mt10 emim-vice-btn' ms-click='showSignup'>Sign up</button>
    </div>
    </script>

    <!-- 注册界面 -->
    <script id='emimSignup' type='tpl'>
    <div ms-visible='display' class="emim-prl emim-auto emim-mt120 emim-sign-wrapper">
        <h3 class='emim-w80 emim-auto emim-theme emim-tl'>Sign Up</h3>
        <input type='text' placeholder='Username' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='username' ms-keydown='signup' ms-blur='check' ms-focus='active'>
        <input id='password' type='password' placeholder='Password' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='password' ms-keydown='signup' ms-blur='checkPwd' ms-focus='active'>
        <input type='password' placeholder='Confirm Password' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='cpassword' ms-keydown='signup' ms-blur='checkPwd' ms-focus='active'>
        <input type='text' placeholder='Nickname' class='emim-db emim-w80 emim-auto emim-mt20' ms-duplex='nickname' ms-keydown='signup' ms-blur='check' ms-focus='active'>
        <button class='emim-db emim-w80 emim-auto emim-center emim-mt50 emim-themebg emim-main-btn' ms-click='signup'>Sign Up</button>
        <div class='emim-signup-back' ms-click='back'></div>
    </div>
    </script>

    <!-- 聊天主界面 -->
    <script id='emimChat' type='tpl'>
    <div id='emimWrapper' ms-visible='display' class='emim-wrapper emim-auto'>
        <div class='emim-h100 emim-prl emim-chatLeft emim-fl'>
            <div class='emim-profile' ms-controller='profile' ms-include='emimProfile'></div>
            <div class='emim-list-tab' ms-include='emimListTab'></div>
            <div class='emim-list' ms-css-height='height' ms-include='emimList'></div>
        </div>
        <div class='emim-h100 emim-prl emim-chatRight'>
            <div class='emim-prl emim-center emim-current-header' ms-controller='targetContact'>
                <span class='emim-chat-to'>{{name}}</span>
                <span class='emim-font emim-pab emim-font-alarm-hover emim-chat-clear'>H</span>
            </div>
            <div class='emim-chat-wrapper' ms-controller='chatWrapper' ms-css-height='height'>
                <div class='emim-h100 emim-chat-content' ms-repeat-item='friend' ms-attr-id='item.name' ms-class='emim-hide:cur!=item.name'></div>
                <div class='emim-h100 emim-chat-content' ms-repeat-item='group' ms-attr-id='item.id' ms-class='emim-hide:cur!=item.id'></div>
                <div class='emim-h100 emim-chat-content' ms-repeat-item='stranger' ms-attr-id='item.name' ms-class='emim-hide:cur!=item.name'></div>
            </div>
            <div class='emim-pab emim-w100 emim-chat-send' ms-include='emimSendWrapper'></div>
        </div>
    </div>
    </script>

    <!-- 个人头像区 -->
    <script id='emimProfile' type='tpl'>
    <img class='emim-avatar emim-profile-avatar' ms-attr-src='avatar' />
    <span class='emim-profile-username'>{{username}}</span>
    <span class='emim-prl emim-fr emim-font emim-font-hover emim-gray emim-profile-dropdown e-function' ms-click='toggle'>g</span>
    <ul class='emim-dropdown-menu e-function' ms-visible='display'>
        <li ms-click='dialog' class='emim-font-hover e-function'>添加好友</li>
        <li ms-click='dialog' class='emim-font-hover e-function'>删除好友</li>
        <li ms-click='logout' class='emim-font-alarm-hover e-function'>退出</li>
    </ul>
    </script>

    <!-- 列表tab -->
    <script id='emimListTab' type='tpl'>
    <ol ms-controller='contactTab'>
        <li class='emim-font emim-font-hover emim-gray emim-friend-tab' ms-class='emim-cur: cur=="friend"' ms-click='toggle("friend")'>a</li>
        <li class='emim-font emim-font-hover emim-gray emim-group-tab' ms-class='emim-cur: cur=="group"' ms-click='toggle("group")'>b</li>
        <li class='emim-font emim-font-hover emim-gray emim-stranger-tab' ms-class='emim-cur: cur=="stranger"' ms-click='toggle("stranger")'>c</li>       
    </ol>
    </script>

    <!-- 联系人列表 -->
    <script id='emimList' type='tpl'>
    <div ms-controller='contactList'>
        <div ms-class='emim-hide: curWrapper!="friend"'>
            <div ms-repeat-item='friend' ms-attr-id='item.name + "Contact"' class='emim-prl emim-contact' ms-click='select' ms-class='emim-contact-cur:cur==item.name + "Contact"' ms-include='emimContact'></div>
        </div>
        <div ms-class='emim-hide: curWrapper!="group"'>
            <div ms-repeat-item='group' ms-attr-roomId='item.roomId' ms-attr-id='item.roomId + "Contact"' class='emim-prl emim-contact' ms-click='select' ms-class='emim-contact-cur:cur==item.roomId + "Contact"' ms-include='emimContact'></div>
        </div>
        <div ms-class='emim-hide: curWrapper!="stranger"'>
            <div ms-repeat-item='stranger' ms-attr-id='item.id + "Contact"' class='emim-prl emim-contact' ms-click='select' ms-class='emim-contact-cur:cur==item.id + "Contact"' ms-include='emimContact'></div>
        </div>
    </div>
    </script>

    <!-- 联系人 -->
    <script id='emimContact' type='tpl'>
        <img class='emim-avatar emim-contact-avatar' ms-attr-src='"img/avatar.png" || item.src'/>
        <span class='emim-prl emim-contact-username'>{{item.name}}</span>
        <span class='emim-contact-msg'></span>
        <span class='emim-contact-count' style='display: none'></span>
    </script>
    
    <!-- 消息发送区 -->
    <script id='emimSendWrapper' type='tpl'>
    <div ms-controller='send' class='emim-prl emim-send-wrapper'>
        <div class='emim-send-function-list'>
            <span class='emim-prl emim-font emim-dib emim-font-hover emim-gray e-face' ms-click='showFace' title='选择表情'>d</span>
            <span class='emim-prl emim-font emim-dib emim-font-hover emim-gray' ms-click='sendFile' title='选择文件'>L</span>
        </div>
        <ul ms-click="faceSelect"  ms-visible='faceShow' class='emim-face-wrapper e-face'>
            <li ms-repeat='faces' class='emim-center e-face'><img class='e-face' ms-attr-src='{{facePath + $val}}' ms-attr-data='$key'></li>
        </ul>
        <div class='emim-w95 emim-auto'>
            <textarea class='emim-w100 emim-chat-textarea' spellcheck='false' ms-duplex='text' ms-on-change='check' ms-keyup='check' ms-on-input='check'></textarea>
        </div>
        <button class='emim-fr emim-disable-btn emim-send-button' ms-click="sendText" ms-class='emim-themebg:enableSend'>Send</button>
        <input id='fileInput' type='file' ms-visible='false' ms-duplex='file' ms-change='realSendFile'>
    </div>
    </script>

    <!-- Dialog -->
    <div ms-controller='dialog' class='emim-dialog' ms-visible='display' style='display:none'>
        <p class='emim-dialog-title'>{{title}}</p>
        <div class='emim-dialog-content'>{{content}}</div>
        <button class='emim-dialog-cancel' ms-click='cancel'>取消</button>
        <button class='emim-dialog-ok' ms-click='ok'>确定</button>
    </div>

    <!-- 群组成员界面 -->
    <script id='emimGroupMember' type='tpl'>
    <div id="option-room-div-modal" class="">
        <button type="button" class="close">×</button>
        <div class="modal-header">
            <h3>群组成员</h3>
        </div>
        <div class="modal-body">
            <div id="room-member-list"></div>
        </div>
    </div>
    </script>

    <!-- prompt -->
    <div ms-controller='prompt' class='emim-w100 emim-prompt' ms-css-top='t' ms-visible='display' style='display:none'>{{content}}</div>

    <!-- loading -->
    <div id='emimLoading' ms-controller='loading' ms-visible='display'>
        <div class='emim-loading'>
            <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 70 70" enable-background="new 0 0 70 70" xml:space="preserve">
                <circle opacity="0.3" fill="none" stroke="#000000" stroke-width="4" stroke-miterlimit="10" cx="35" cy="35" r="11"/>
                <path fill="none" stroke="#E5E5E5" stroke-width="4" stroke-linecap="round" stroke-miterlimit="10" d="M24,35c0-6.1,4.9-11,11-11c2.8,0,5.3,1,7.3,2.8"/>
                    <image src="/webim/resources/loading.gif" width="20" style="margin-top:10px;" />
            </svg>
        </div>
    </div>
    <!--layer-->
    <div class='emim-w100 emim-h100 emim-layer' ms-visible='display' ms-controller='layer'></div>
</body>
</html>
